(function(api){var ElementBanner=api.ElementBanner=api.extendReactClass('MixinBase',{propTypes:{type:React.PropTypes.string,close:React.PropTypes.func,extension:React.PropTypes.string},getDefaultProps:function(){return{type:'',close:null,extension:''};},getInitialState:function(){return{html:''};},componentWillMount:function(){if(this.props.type!=''){var link=api.urls.ajaxBase+'&context=banner';link+='&type='+this.props.type;link+='&component='+this.props.extension;api.Ajax.request(link,function(res){if(res.responseJSON&&res.responseJSON.data){this.setState({name:res.responseJSON.data.name||'',html:res.responseJSON.data.content||''});}}.bind(this));}},render:function(){return null;},initActions:function(){this.parent();if(this.refs.mountedDOMNode&&!this.refs.mountedDOMNode._listened_clickEvent){api.Event.add(this.refs.mountedDOMNode,'click',this.handleClick);this.refs.mountedDOMNode._listened_clickEvent=true;}},handleClick:function(event){if(!event.target.classList||!event.target.classList.contains('remove-banner')){if(event.target.nodeName=='A'){event.target.target='_blank';}}},deinitActions:function(){this.parent();if(this.refs.mountedDOMNode&&this.refs.mountedDOMNode._listened_clickEvent){delete this.refs.mountedDOMNode._listened_clickEvent;api.Event.remove(this.refs.mountedDOMNode,'click',this.handleClick);}}});var ElementFeedback=api.ElementFeedback=api.extendReactClass('MixinBase',{propTypes:{modalTitle:React.PropTypes.string,modalMessage:React.PropTypes.string,formTitle:React.PropTypes.string,question:React.PropTypes.string,answers:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.array]),customAnswerTextLabel:React.PropTypes.string,cancelButtonTextLabel:React.PropTypes.string,cancelButtonClassName:React.PropTypes.string,submitButtonTextLabel:React.PropTypes.string,submitButtonClassName:React.PropTypes.string,feedbackReceiver:React.PropTypes.string,reloadPageWhenFinish:React.PropTypes.boolean},getDefaultProps:function(){return{modalTitle:'Uninstall component',modalMessage:"Please consider leaving your feedback as to why you're uninstalling our component. We will use this feedback to improve future versions of the product.",formTitle:'FEEDBACK',question:'Reason for uninstalling',answers:'',customAnswerTextLabel:'Describe your experience',cancelButtonTextLabel:'Cancel',cancelButtonClassName:'btn-default',submitButtonTextLabel:'Uninstall',submitButtonClassName:'btn-danger',feedbackReceiver:'index.php?option=com_ajax&group=system&plugin=jsnextfw',reloadPageWhenFinish:true};},getInitialState:function(){return this.props;},componentWillMount:function(){if(typeof this.state.answers=='string'&&this.state.answers!=''){api.Ajax.request(this.state.answers,function(res){if(res.responseJSON&&res.responseJSON.success){this.setState({answers:res.responseJSON.data});}else{this.sendFeedback();}}.bind(this));}},render:function(){if(typeof this.state.answers=='string'||!this.state.answers.length){return null;}var defaultAnswer=this.state.answers[0].value;if(defaultAnswer===undefined){defaultAnswer=this.state.answers[0];}this.modal=api.Modal.get({type:'form',title:this.state.modalTitle,content:{form:{description:this.state.modalMessage,rows:[{title:this.state.formTitle,controls:{reason:{type:'select',label:this.state.question,chosen:false,options:this.state.answers,default:this.state.answers[0].value||this.state.answers[0],className:'col-12',labelClass:'d-block',inputClass:'d-block'},experience:this.state.customAnswerTextLabel?{type:'textarea',label:this.state.customAnswerTextLabel,rows:10,className:'col-12',labelClass:'d-block',inputClass:'d-block'}:null}}]},className:'jsn-feedback-form',saveButton:'.jsn-feedback-modal .modal-footer .btn-send-feedback',saveHandler:this.sendFeedback,disableSaveButton:false},buttons:[this.state.cancelButtonTextLabel?{text:this.state.cancelButtonTextLabel,className:'btn '+this.state.cancelButtonClassName,onClick:api.Modal.hide}:null,this.state.submitButtonTextLabel?{text:this.state.submitButtonTextLabel,className:'btn btn-send-feedback '+this.state.submitButtonClassName}:null],className:'jsn-feedback-modal'});return null;},sendFeedback:function(data){if(this.modal){var buttons=this.modal.refs.mountedDOMNode.querySelectorAll('.modal-footer .btn');for(var i=0;i<buttons.length;i++){buttons[i].disabled=true;if(buttons[i].classList.contains('btn-send-feedback')){buttons[i].origHTML=buttons[i].origHTML||buttons[i].innerHTML;buttons[i].innerHTML='<i class="fa fa-circle-o-notch fa-spin"></i>';}}}api.Ajax.request(this.state.feedbackReceiver,function(res){var toggleButtonState=true;if(res.responseJSON&&res.responseJSON.success){if(this.state.reloadPageWhenFinish){toggleButtonState=false;(window.top||window).location.reload();}else{api.Event.trigger(this.modal,'FeedbackSent');api.Modal.hide();}}else{alert(res.responseJSON?res.responseJSON.data:res.responseText);}if(toggleButtonState){if(buttons){for(var i=0;i<buttons.length;i++){buttons[i].disabled=false;if(buttons[i].classList.contains('btn-send-feedback')){buttons[i].innerHTML=buttons[i].origHTML;}}}}}.bind(this),data);}});var ElementForm=api.ElementForm=api.extendReactClass('MixinBase',{propTypes:{id:React.PropTypes.string,rel:React.PropTypes.element,form:React.PropTypes.object,values:React.PropTypes.object,inline:React.PropTypes.boolean,toolbar:React.PropTypes.boolean,className:React.PropTypes.string,emptyClass:React.PropTypes.string,emptyMessage:React.PropTypes.node,saveButton:React.PropTypes.string,saveHandler:React.PropTypes.string,disableSaveButton:React.PropTypes.boolean,textMapping:React.PropTypes.object},getDefaultProps:function(){return{id:'',rel:null,form:{},values:{},inline:true,toolbar:false,className:'',emptyClass:'empty-form',emptyMessage:null,saveButton:null,saveHandler:null,disableSaveButton:true,textMapping:null};},getInitialState:function(){return this.props;},render:function(){var form=[];if(this.state.form){if(this.state.form.html){form.push(this.state.form.html);}else{delete this.loadingControlComponent;if(this.state.form.description){form.push(React.createElement('p',{className:'form-description'},api.Text.parse(this.state.form.description)));}for(var p in{rows:'',cols:'',groups:'',controls:''}){if(this.state.form[p]){form=form.concat(this['render'+api.Text.capitalize(p)](this.state.form[p]));}}}}if(!form.length){return React.createElement('div',{ref:'mountedDOMNode',className:'form-container '+this.state.emptyClass},this.state.emptyMessage?api.Text.parse(this.state.emptyMessage):React.createElement(api.ElementLoading,{inline:true}));}var toolbar;if(this.state.toolbar){toolbar=React.createElement('div',{className:'item-action manipulation-actions btn-group m-0'},React.createElement('button',{type:'button',className:'btn',onClick:this.state.rel.toggleItem},React.createElement('i',{className:'fa fa-eye'})),React.createElement('button',{type:'button',className:'btn',onClick:this.state.rel.cloneItem},React.createElement('i',{className:'fa fa-files-o'})),React.createElement('button',{type:'button',className:'btn',onClick:this.state.rel.deleteItem},React.createElement('i',{className:'fa fa-trash'})));}var formTitle;if(toolbar||this.state.form.title){var className='clearfix sidebar-heading border-bottom px-3 d-flex align-items-center',title=this.state.form.title;if(typeof title=='string'){className+=' '+title.replace(/[^a-zA-Z0-9\-_]+/g,'-').toLowerCase();title=React.createElement('span',{className:'form-title'},api.Text.parse(title));}formTitle=React.createElement('div',{className:className},title,toolbar);}return React.createElement('div',{id:this.state.id?this.state.id:api.Text.toId('form',true),ref:'mountedDOMNode',className:'form-container '+this.state.className},formTitle,React.createElement('div',{className:this.state.form['class']?this.state.form['class']:null},form));},renderRows:function(rows){var elms=[];rows.forEach(row=>{var columns=[],groups=[],controls=[];if(row.cols){columns=this.renderCols(row.cols);}if(row.groups){groups=this.renderGroups(row.groups);}if(row.controls){controls=this.renderControls(row.controls);}if(columns.length||groups.length||controls.length){elms.push(React.createElement('div',{className:'row mx-0'+(this.isVisible(row.requires)?'':' hidden')},row.title||row.prefix?React.createElement('div',{className:'col-12 row-title'},row.title?React.createElement('h6',{className:'font-weight-bold'},api.Text.parse(row.title)):null,row.prefix?React.createElement('p',{className:'row-description'},api.Text.parse(row.prefix)):null):null,columns,groups,controls,row.suffix?React.createElement('div',{className:'col-12'},row.suffix?React.createElement('p',{className:'row-description'},api.Text.parse(row.suffix)):null):null));}});return elms;},renderCols:function(cols){var elms=[];cols.forEach(col=>{var rows=[],groups=[],controls=[];if(col.rows){rows=this.renderRows(col.rows);}if(col.groups){groups=this.renderGroups(col.groups);}if(col.controls){controls=this.renderControls(col.controls);}if(rows.length||groups.length||controls.length){elms.push(React.createElement('div',{className:(col['class']||'')+(this.isVisible(col.requires)?'':' hidden')},col.title?React.createElement('div',{className:'column-title'},React.createElement('h6',{className:'font-weight-bold'},api.Text.parse(col.title))):null,col.description?React.createElement('p',{className:'column-description'},api.Text.parse(col.description)):null,rows,groups,controls));}});return elms;},renderGroups:function(groups){var elms=[];groups.forEach(group=>{var rows=[],columns=[],controls=[];if(group.rows){rows=this.renderRows(group.rows);}if(group.cols){columns=this.renderCols(group.cols);}if(group.controls){controls=this.renderControls(group.controls);}if(rows.length||columns.length||controls.length){elms.push(React.createElement('fieldset',{className:(group['class']||'')+(this.isVisible(group.requires)?'':' hidden')},group.title?React.createElement('legend',null,api.Text.parse(group.title)):null,group.description?React.createElement('p',{className:'group-description'},api.Text.parse(group.description)):null,rows,columns,controls));}});return elms;},renderControls:function(controls){var elms=[];this.values=this.values||{};for(var setting in controls){if(!controls[setting]){continue;}var keyName=(this.state.rel?this.state.rel.props.id:'')+'_'+setting;var value=controls[setting]['default'];if(this.state.values&&this.state.values[setting]!==undefined&&this.state.values[setting]!=value){value=this.state.values[setting];}else if(typeof value=='string'){value=api.Text.parse(value);}this.values[setting]=value;var control=api.Text.toCamelCase(controls[setting].type,true);if(control.indexOf('Input')<0){control='Input'+control;}var Component=api.findObject(control);if(!Component&&api.inputs){var url;for(var p in api.inputs){if(api.inputs[p].indexOf(controls[setting].type)>-1){url=p+'/'+controls[setting].type+'.js';}}if(url){api.Ajax.request(url,function(res){eval('(function(api){'+res.responseText+'})(api);');});this.loadingControlComponent=this.loadingControlComponent||true;}else if(!api.InputText){for(var p in api.inputs){if(api.inputs[p].indexOf('text')>-1){url=p+'/text.js';}}api.Ajax.request(url,function(res){eval('(function(api){'+res.responseText+'})(api);');});this.loadingControlComponent=this.loadingControlComponent||true;}}if(Component||api.InputText){var props={id:keyName,key:keyName,ref:setting,form:this,type:controls[setting].type,value:value,setting:setting,control:controls[setting]};if(controls[setting].config){props.config=controls[setting].config;}for(var p in controls[setting]){if(p.indexOf('data-')==0){props[p]=controls[setting][p];}}elms.push(React.createElement(Component||api.InputText,props));}this.state.values[setting]=value;}if(this.loadingControlComponent){this.loadingControlComponentTimer&&clearTimeout(this.loadingControlComponentTimer);this.loadingControlComponentTimer=setTimeout(this.forceUpdate.bind(this),500);}return elms;},componentDidUpdate:function(){this.parent();if(!this.loadingControlComponent){if(this.values){for(var p in this.state.values){if(this.values[p]!==undefined){if(this.state.values[p]!=this.values[p]){this.state.values[p]=this.values[p];}}else{delete this.state.values[p];}}}var inputs=this.refs.mountedDOMNode.querySelectorAll('input,textarea');for(var i=0,n=inputs.length;i<n;i++){var input=inputs[i];if(input.nodeName=='TEXTAREA'||['checkbox','radio'].indexOf(input.type)<0){if(!input._listened_focusBlurKeyupEvent){api.Event.add(input,'focus',this.focus);api.Event.add(input,'blur',this.blur);api.Event.add(input,'keyup',this.keyup);input._listened_focusBlurKeyupEvent=true;}}}if(this.state.saveButton&&this.state.saveHandler){var saveButton=document.querySelectorAll(this.state.saveButton);for(var i=0;i<saveButton.length;i++){if(!saveButton[i]._listened_clickEvent||saveButton[i]._listened_clickEvent.indexOf(this)<0){saveButton[i]._listened_clickEvent=saveButton[i]._listened_clickEvent||[];if(saveButton[i].getAttribute('onclick')){saveButton[i].removeAttribute('onclick');}if(this.state.disableSaveButton){saveButton[i].disabled=true;}if(!saveButton[i]._listened_clickEvent.length){api.Event.add(saveButton[i],'click',api.ElementForm.clickSaveButton);}saveButton[i]._listened_clickEvent.push(this);}}}api.Event.trigger(this,'FormRendered');}},componentWillUnmount:function(){this.parent();var inputs=this.refs.mountedDOMNode.querySelectorAll('input,textarea');for(var i=0,n=inputs.length;i<n;i++){var input=inputs[i];if(input.nodeName=='TEXTAREA'||['checkbox','radio'].indexOf(input.type)<0){if(input._listened_focusBlurKeyupEvent){delete input._listened_focusBlurKeyupEvent;api.Event.remove(input,'focus',this.focus);api.Event.remove(input,'blur',this.blur);api.Event.remove(input,'keyup',this.keyup);}}}if(this.state.saveButton&&this.state.saveHandler){var saveButton=document.querySelectorAll(this.state.saveButton);for(var i=0;i<saveButton.length;i++){if(saveButton[i]._listened_clickEvent&&saveButton[i]._listened_clickEvent.indexOf(this)>-1){saveButton[i]._listened_clickEvent.splice(saveButton[i]._listened_clickEvent.indexOf(this),1);if(!saveButton[i]._listened_clickEvent.length){api.Event.remove(saveButton[i],'click',api.ElementForm.clickSaveButton);}saveButton[i].disabled=false;}}}},focus:function(event){this.skipSaving=true;if(this.state.inline){event.target.__current__=event.target.value;}},blur:function(event){this.skipSaving=false;if(this.state.inline&&event.target.__current__!=event.target.value){this.saveSettings();}},keyup:function(event){if(this.state.inline&&event.keyCode==13&&event.target.__current__!=event.target.value){this.skipSaving=false;this.saveSettings();}this.skipSaving=true;},isVisible:function(requires){var visible=true;if(requires){for(var p in requires){if(!visible){return;}if(requires.hasOwnProperty(p)){if(['string','number'].indexOf(typeof requires[p])>-1){if(!isNaN(parseInt(requires[p]))){if(parseInt(requires[p])!=parseInt(this.state.values[p])){visible=false;}}else if(requires[p]!=this.state.values[p]){visible=false;}}else if(requires[p]instanceof Array){switch(requires[p][0]){case '=':case '==':if(!isNaN(parseInt(requires[p][1]))){if(parseInt(requires[p][1])!=parseInt(this.state.values[p])){visible=false;}}else if(requires[p][1]!=this.state.values[p]){visible=false;}break;case '!=':case '<>':if(!isNaN(parseInt(requires[p][1]))){if(parseInt(requires[p][1])==parseInt(this.state.values[p])){visible=false;}}else if(requires[p][1]==this.state.values[p]){visible=false;}break;}}}}}return visible;},updateState:function(setting,value){var values=this.state.values;if(!values||values instanceof Array){values={};}values[setting]=value;if(this.state.rel&&this.state.rel.updateState){this.state.rel.updateState(values);}if(this.skipSaving){this.state.values=values;this.setting_just_changed=setting;}else{this.setState({values:values});api.Event.trigger(this,'FormChanged',{changedElement:this.refs[setting]});delete this.setting_just_changed;}if(this.state.inline){this.saveSettings(values);}else if(this.state.saveButton&&this.state.saveHandler){var saveButton=document.querySelectorAll(this.state.saveButton);for(var i=0;i<saveButton.length;i++){saveButton[i].disabled=false;}}},saveSettings:function(values,force){if(force||!this.skipSaving){values=values||this.state.values;if(this.state.rel&&this.state.rel.saveSettings){this.state.rel.saveSettings(values);}if(this.setting_just_changed){api.Event.trigger(this,'FormChanged',{changedElement:this.refs[this.setting_just_changed]});delete this.setting_just_changed;}}}});api.ElementForm.clickSaveButton=function(event){event.preventDefault();var target=event.target;while(target&&target.nodeName!='BODY'&&!target._listened_clickEvent){target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}var forms={};for(var i=0;i<target._listened_clickEvent.length;i++){if(typeof target._listened_clickEvent[i].state.saveHandler=='function'){target._listened_clickEvent[i].state.saveHandler(target._listened_clickEvent[i].state.values);}else{forms[target._listened_clickEvent[i].state.saveHandler]=forms[target._listened_clickEvent[i].state.saveHandler]||{};for(var p in target._listened_clickEvent[i].state.values){forms[target._listened_clickEvent[i].state.saveHandler][p]=target._listened_clickEvent[i].state.values[p];}}}if(JSON.stringify(forms)!='{}'){target.disabled=true;target.origHTML=target.origHTML||target.innerHTML;target.innerHTML='<i class="fa fa-circle-o-notch fa-spin"></i>';for(var action in forms){api.Ajax.request(action,function(res){if(!res.responseJSON||!res.responseJSON.success){api.Modal.error(res);}else{var msg;if(res.responseJSON.data&&res.responseJSON.data.message){msg=res.responseJSON.data.message;}else{msg=api.Text.parse('JSN_EXTFW_CHANGES_SAVED_SUCCESSFULLY');}var exist=document.querySelector('.noty_message');if(!exist||exist.textContent.trim()!=msg){noty({text:msg,theme:'relax',layout:'top',type:'success',animation:{open:'animated fadeIn',close:'animated fadeOut'}});setTimeout(function(){document.querySelector('.noty_message').click();},2000);}}if(target.origHTML){target.innerHTML=target.origHTML;delete target.origHTML;}if(!res.responseJSON||!res.responseJSON.success){target.disabled=false;}},forms[action]);}}};var ElementInput=api.ElementInput=api.extendReactClass('MixinBase',{propTypes:{type:React.PropTypes.string,name:React.PropTypes.string,value:React.PropTypes.string,className:React.PropTypes.string,placeholder:React.PropTypes.string},getDefaultProps:function(){return{type:'text',name:'',value:'',className:'',placeholder:''};},getInitialState:function(){return{value:this.props.value};},render:function(){var props={ref:'mountedDOMNode',type:this.props.type,name:this.props.name,value:this.state.value,className:this.props.className,placeholder:this.props.placeholder};if(['checkbox','radio'].indexOf(this.props.type)>-1){props.checked=this.props.value==this.state.value;props.onClick=this.change;}else{props.onClick=this.props.onClick||null;props.onChange=this.change;}return React.createElement('input',props);},change:function(event){var value;if(['checkbox','radio'].indexOf(this.props.type)>-1){value=event.target.checked?this.props.value:null;}else{value=event.target.value;}if(!this.props.form||this.props.form.skipSaving){this.setState({value:value});}if(this.props.form){this.props.form.updateState(setting,value);}if(event.type=='click'&&typeof this.props.onClick=='function'){this.props.onClick(event,this);}else if(event.type=='change'&&typeof this.props.onChange=='function'){this.props.onChange(event,this);}}});var ElementLoading=api.ElementLoading=api.extendReactClass('MixinBase',{propTypes:{inline:React.PropTypes.boolean,size:React.PropTypes.string},getDefaultProps:function(){return{inline:false,size:'3x'};},render:function(){var indicator=React.createElement('i',{className:'fa fa-circle-o-notch fa-spin fa-'+this.props.size});if(this.props.inline){return indicator;}return React.createElement('div',{className:'pa-loading-mask'},React.createElement('div',{className:'pa-loading-indicator'},indicator));}});var ElementMenu=api.ElementMenu=api.extendReactClass('MixinBase',{propTypes:{id:React.PropTypes.string,type:React.PropTypes.string,items:React.PropTypes.array,className:React.PropTypes.string,container:React.PropTypes.element,doubleWrapper:React.PropTypes.boolean},getDefaultProps:function(){return{items:[]};},getInitialState:function(){return this.props;},render:function(){var className=[];switch(this.state.type){case 'navbar':className.push('navbar-nav');break;case 'dropdown':className.push('dropdown-menu');break;}if(this.props.className){className.push(this.props.className);}return React.createElement('ul',{ref:'mountedDOMNode',className:className.join(' ')},this.state.type=='dropdown'&&this.props.doubleWrapper?React.createElement('div',{className:'dropdown-menu-inner'},this.renderItems()):this.renderItems());},renderItems:function(){return this.state.items.map((item,index)=>{if(typeof item!='object'){return;}var link=item.url||item.href||item.link;if(item.separator||(!link||link=='')&&(!item.title||item.title=='')&&(!item.text||item.text=='')){return React.createElement('li',{className:this.state.type+'-divider'});}var subItems=item.items||(item.submenu&&item.submenu.length?item.submenu:null);var listItemClass=[];if(this.state.type=='navbar'){listItemClass.push('nav-item');}if(subItems){if(this.state.type=='dropdown'){listItemClass.push('dropdown-submenu');}else{listItemClass.push('dropdown');if(item.openOnHover!==undefined&&!item.openOnHover){listItemClass.push('no-open-on-hover');}if(item.hideOnClickOutsideOnly!==undefined&&item.hideOnClickOutsideOnly){listItemClass.push('hide-on-click-outside-only');}}}if(item.active){listItemClass.push('active');}if(item.selected){listItemClass.push('selected');}if(item['class']||item.className){listItemClass.push(item['class']||item.className);}if(!link||link==''){listItemClass.push('heading');}var onClick;if(item.onClick){if(typeof item.onClick=='function'){onClick=item.onClick;}else if(this.state.container&&typeof this.state.container[item.onClick]=='function'){onClick=this.state.container[item.onClick];}else if(typeof window[item.onClick]=='function'){onClick=window[item.onClick];}}if(!onClick&&(item.ajax||item.modal)){onClick=this.executeAction.bind(this,item,index);}var linkElementClass=[];switch(this.state.type){case 'navbar':linkElementClass.push('nav-link');break;case 'dropdown':linkElementClass.push('dropdown-item');break;}if(item.linkClass){listItemClass.push(item.linkClass);}var image;if(item.image){image=React.createElement('img',{src:item.image});}var icon;if(item.icon){icon=React.createElement('i',{className:'fa fa-'+item.icon});}var badge;if(item.badge){badge=React.createElement('span',{className:'badge '+(item.badgeType||'badge-info')},item.badge);}var content;if(image){content=image;}else{content=[];if(icon){content.push(icon);}if(item.text||item.title){var t=api.Text.parse(item.text||item.title);if(t instanceof Array){content=content.concat(t);}else{content.push(t);}}if(badge){content=content.concat([' ',badge]);}}var props={className:linkElementClass.join(' ')};if(link&&link!=''){props.href=link;}if(item.text&&item.title){props.title=item.title;}if(item.target){props.target=item.target;}if(onClick){props.onClick=onClick;}for(var p in item){if(p.indexOf('data-')==0){props[p]=item[p];}}link=React.createElement('a',props,content);var description;if(item.description){if(typeof item.description=='string'){description=React.createElement('p',null,api.Text.parse(item.description));}else{description=item.description;}}var suffix;if(item.suffix){suffix=api.Text.parse(item.suffix);}return React.createElement('li',{ref:'item-'+index,key:'item-'+index+'-'+api.Text.toId(item.text||item.title),onClick:this.handleClick,onMouseOver:this.handleMouseOver,className:listItemClass.join(' ')},link,description,suffix,subItems?React.createElement(api.ElementMenu,{id:item.dropdownId,type:'dropdown',items:subItems,className:item.dropdownClass,container:this.state.container||this,doubleWrapper:this.props.doubleWrapper}):null);});},componentDidMount:function(){this.parent();api.Event.add(document,'click',this.hideDropdownMenu);},initActions:function(){this.parent();for(var i=0;i<this.state.items.length;i++){var item=this.state.items[i];if(item.callback){var callback;if(typeof item.callback=='function'){callback=item.callback;}else if(this.state.container&&typeof this.state.container[item.callback]=='function'){callback=this.state.container[item.callback];}else if(typeof api[item.callback]=='function'){callback=api[item.callback];}else if(typeof window[item.callback]=='function'){callback=window[item.callback];}if(callback){callback('init',item,this.refs['item-'+i]);}}}},componentWillUnmount:function(){this.parent();api.Event.remove(document,'click',this.hideDropdownMenu);},handleClick:function(event){var target=event.target;while(target&&target.nodeName!='LI'&&target.nodeName!='BODY'){target=target.parentNode;}if(target.nodeName=='LI'&&target.classList.contains('dropdown')){event.stopPropagation();var openingDropdownMenu=target.parentNode.querySelector('.dropdown.open');if(openingDropdownMenu&&openingDropdownMenu!=target){openingDropdownMenu.classList.remove('open');target.classList.add('open');}else if(!target.classList.contains('hide-on-click-outside-only')||!target.classList.contains('open')){target.classList.toggle('open');}}},handleMouseOver:function(event){var target=event.target;while(target&&target.nodeName!='LI'&&target.nodeName!='BODY'){target=target.parentNode;}if(target.nodeName=='LI'&&target.classList.contains('dropdown')&&!target.classList.contains('no-open-on-hover')){var openingDropdownMenu=target.parentNode.querySelector('.dropdown.open');if(openingDropdownMenu&&openingDropdownMenu!=target){target.click();}}},hideDropdownMenu:function(event){var target=event.target;while(target&&target.nodeName!='BODY'){var found=false;if(target.classList&&target.classList.contains('dropdown-menu')){break;}else if(target.classList&&target.classList.contains('dropdown')){for(var p in this.refs){if(p.indexOf('item-')==0&&this.refs[p]==target){found=true;break;}}}if(found){break;}target=target.parentNode;}if(!(target&&target.classList&&target.classList.contains('dropdown'))){for(var p in this.refs){if(p.indexOf('item-')==0&&this.refs[p].classList.contains('dropdown')){if(this.refs[p].classList.contains('open')){this.refs[p].classList.remove('open');break;}}}}},executeAction:function(action,index,event){event.preventDefault();if(action.modal){var openingDropdownMenu=document.querySelector('.dropdown.open');if(openingDropdownMenu){openingDropdownMenu.classList.remove('open');}if(this.refs['item-'+index].parentNode.parentNode.classList.contains('.dropdown-menu')){this.refs['item-'+index].parentNode.parentNode.style.display='none';}}this.parent(action,{},this.refs['item-'+index],event,this.state.container||this);}});var ElementModal=api.ElementModal=api.extendReactClass('MixinBase',{propTypes:{id:React.PropTypes.string,show:React.PropTypes.boolean,type:React.PropTypes.string,title:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.element]),content:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.element,React.PropTypes.object]),buttons:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.array]),width:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.number]),height:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.number]),centralize:React.PropTypes.boolean,preserve:React.PropTypes.boolean,confirm:React.PropTypes.func,cancel:React.PropTypes.func,showCloseButton:React.PropTypes.boolean},getDefaultProps:function(){return{id:'',show:false,type:'',title:'',content:'',buttons:[],width:'720px',height:'',centralize:true,preserve:false,confirm:null,cancel:null,showCloseButton:false};},getInitialState:function(){return this.props;},render:function(){var content;switch(this.state.type){case 'form':if(!this.state.content.parent){this.state.content.parent=this;}this.state.content.ref='form';content=React.createElement(api.ElementForm,this.state.content);break;case 'iframe':this.state.content.ref='iframe';this.state.content.src=this.state.content.src||'about:blank';this.state.content.key=this.state.content.src.replace(/[^a-zA-Z0-9\-_]+/g,'');if(this.state.content.height===undefined){this.state.content.height='auto';}content=React.createElement('iframe',this.state.content);break;default:content=api.Text.parse(this.state.content);break;}var footer,buttons=[];if(this.state.buttons instanceof Array&&this.state.buttons.length){this.state.buttons.forEach(button=>{if(button){var button_text='';if(button.text){button_text=api.Text.parse(button.text);}var props={};for(var p in button){if(p=='onClick'){props[p]=function(cb,event){if(typeof cb=='function'){cb(this,event);}}.bind(this,button[p]);}else if(p=='class'){props.className=button[p];}else{props[p]=button[p];}}if(!props.className){props.className='btn btn-default';}if(!props.href&&!props.type){props.type='button';}buttons.push(React.createElement(props.href?'a':'button',props,button_text));}});}if(this.state.buttons!='disabled'&&!buttons.length){buttons=[React.createElement('button',{type:'button',onClick:this.confirm,className:'btn btn-primary'},api.Text.parse('ok')),React.createElement('button',{type:'button',onClick:this.cancel,className:'btn btn-default'},api.Text.parse('cancel'))];}if(buttons.length){footer=React.createElement('div',{className:'modal-footer'},buttons);}return React.createElement('div',{id:this.state.id?this.state.id:api.Text.toId('modal',true),ref:'mountedDOMNode',style:{display:'none'},className:'modal fade'+(this.state.className?' '+this.state.className:'')},React.createElement('div',{className:'modal-dialog'},React.createElement('div',{className:'modal-content'},this.state.title?React.createElement('div',{className:'modal-header'},React.createElement('h4',{className:'modal-title'},api.Text.parse(this.state.title)),this.state.showCloseButton?React.createElement('button',{type:'button',onClick:this.close,className:'close'},React.createElement('span',null,'\xD7')):null):null,React.createElement('div',{className:'modal-body'},content),footer)));},initActions:function(){if(this.state.show){this.show();}if(this.state.type=='form'&&this.refs.form){this.refs.form.setState({inline:false});}},show:function(event){event&&event.preventDefault();this.closeTimeout&&clearTimeout(this.closeTimeout);if(typeof this.state.onModalShown=='function'){api.Event.add(this,'ModalShown',this.state.onModalShown);}if(typeof this.state.onModalHidden=='function'){api.Event.add(this,'ModalHidden',this.state.onModalHidden);}this.refs.mountedDOMNode.style.display='block';var modal_dialog=this.refs.mountedDOMNode.querySelector('.modal-dialog');modal_dialog.style.width='initial';if(this.state.width){var width=parseInt(this.state.width);if(this.state.width.substr&&this.state.width.substr(-1)=='%'){width=window.innerWidth/100 * width;}if(window.innerWidth<width){width=window.innerWidth;}modal_dialog.style.width=width+'px';modal_dialog.style.maxWidth='initial';}modal_dialog.style.marginTop='initial';var container_css=window.getComputedStyle(modal_dialog),modal_header=this.refs.mountedDOMNode.querySelector('.modal-content>.modal-header'),header_rect=modal_header?modal_header.getBoundingClientRect():{height:0},modal_footer=this.refs.mountedDOMNode.querySelector('.modal-content>.modal-footer'),footer_rect=modal_footer?modal_footer.getBoundingClientRect():{height:0},modal_body=this.refs.mountedDOMNode.querySelector('.modal-content>.modal-body'),height;modal_body.style.height='initial';modal_body.style.overflowX='hidden';modal_body.style.overflowY='auto';if(this.state.height){var height=parseInt(this.state.height);if(this.state.height.substr(-1)=='%'){height=window.innerHeight/100 * height;}if(window.innerHeight<height){height=window.innerHeight;}height-=header_rect.height+footer_rect.height;modal_body.style.height=height+'px';modal_body.style.maxHeight='initial';}else{height=window.innerHeight-parseInt(container_css.getPropertyValue('margin-top'))-parseInt(container_css.getPropertyValue('margin-bottom'))-header_rect.height-footer_rect.height;modal_body.style.height='initial';modal_body.style.maxHeight=height+'px';}if(this.state.type=='iframe'&&['auto','100%'].indexOf(this.state.content.height)>-1){var modal_body_css=window.getComputedStyle(modal_body),iframe_css=window.getComputedStyle(this.refs.iframe);this.refs.iframe.style.height=height-parseInt(modal_body_css.getPropertyValue('padding-top'))-parseInt(modal_body_css.getPropertyValue('padding-bottom'))-parseInt(iframe_css.getPropertyValue('border-top-width'))-parseInt(iframe_css.getPropertyValue('border-bottom-width'))+'px';modal_body.style.overflowY='hidden';}if(this.state.centralize){var rect=modal_dialog.getBoundingClientRect();modal_dialog.style.transform='none';modal_dialog.style.marginTop='-'+rect.height/2+'px';modal_dialog.style.marginLeft='-'+rect.width/2+'px';}if(this.refs.form&&!this.refs.form._listened_changeEvent){api.Event.add(this.refs.form.refs.mountedDOMNode,'change',this.update);this.refs.form._listened_changeEvent=true;}if(this.refs.form&&!this.refs.form._listened_FormRenderedEvent){api.Event.add(this.refs.form,'FormRendered',this.update);this.refs.form._listened_FormRenderedEvent=true;}if(!this.refs.mountedDOMNode._listened_resizeEvent){api.Event.add(window,'resize',this.show);this.refs.mountedDOMNode._listened_resizeEvent=true;}this.refs.mountedDOMNode.classList.add('show');var inputs=this.refs.mountedDOMNode.querySelectorAll('.modal-body input[type="text"]');for(var i=0;i<inputs.length;i++){if(!inputs[i]._listenedKeyUpEvent){api.Event.add(inputs[i],'keyup',this.handleKeyUp);inputs[i]._listenedKeyUpEvent=true;}}api.Event.trigger(this,'ModalShown');},update:function(event){if(this.state.centralize&&!this.state.height&&this.state.type=='form'&&this.refs.form){var formHeight=this.refs.form.refs.mountedDOMNode.getBoundingClientRect().height;if(this.lastFormHeight!=formHeight){this.show();}this.lastFormHeight=formHeight;}api.Event.trigger(this,'ModalUpdated');},close:function(event){event&&event.preventDefault();if(event!==false&&typeof this.state.close=='function'){this.state.close();}this.refs.mountedDOMNode.classList.remove('show');this.closeTimeout=setTimeout(function(){this.refs.mountedDOMNode.style.display='none';}.bind(this),250);if(this.refs.mountedDOMNode._listened_resizeEvent){delete this.refs.mountedDOMNode._listened_resizeEvent;api.Event.remove(window,'resize',this.show);}if(this.refs.form&&this.refs.form._listened_FormRenderedEvent){delete this.refs.form._listened_FormRenderedEvent;api.Event.remove(this.refs.form,'FormRendered',this.update);}if(this.refs.form&&this.refs.form._listened_changeEvent){delete this.refs.form._listened_changeEvent;api.Event.remove(this.refs.form.refs.mountedDOMNode,'change',this.update);}var inputs=this.refs.mountedDOMNode.querySelectorAll('.modal-body input[type="text"]');for(var i=0;i<inputs.length;i++){if(inputs[i]._listenedKeyUpEvent){delete inputs[i]._listenedKeyUpEvent;api.Event.remove(inputs[i],'keyup',this.handleKeyUp);}}api.Event.trigger(this,'ModalHidden');setTimeout(function(){if(typeof this.state.onModalShown=='function'){api.Event.remove(this,'ModalShown',this.state.onModalShown);}if(typeof this.state.onModalHidden=='function'){api.Event.remove(this,'ModalHidden',this.state.onModalHidden);}}.bind(this),100);},confirm:function(event){event.preventDefault();if(this.state.type=='form'&&this.refs.form){this.refs.form.saveSettings(null,true);}if(typeof this.state.confirm=='function'){this.state.confirm(this);}else if(this.props.parent&&typeof this.props.parent.confirm=='function'){this.props.parent.confirm(this);}this.close(false);},cancel:function(event){event.preventDefault();if(typeof this.state.cancel=='function'){this.state.cancel(this);}else if(this.props.parent&&typeof this.props.parent.cancel=='function'){this.props.parent.cancel(this);}this.close(false);}});var ElementTooltip=api.ElementTooltip=api.extendReactClass('MixinBase',{propTypes:{id:React.PropTypes.string,hint:React.PropTypes.string,position:React.PropTypes.string},getDefaultProps:function(){return{id:'',hint:'',position:'auto'};},render:function(){return React.createElement('span',{ref:'mountedDOMNode',key:this.props.id||api.Text.toId(),className:'has-tooltip','data-toggle':'tooltip','data-placement':this.props.position},React.createElement('i',{className:'fa fa-question-circle'}));},initActions:function(){this.parent();this.initTooltip();},deinitActions:function(){this.parent();this.deinitTooltip();},initTooltip:function(){this.deinitTooltip();jQuery(this.refs.mountedDOMNode).tooltip({html:true,title:this.props.hint,trigger:'hover',container:this.refs.mountedDOMNode.parentNode.parentNode||document.body}).click(function(event){event.preventDefault();event.stopPropagation();});},deinitTooltip:function(){if(jQuery(this.refs.mountedDOMNode).data('tooltip')){try{jQuery(this.refs.mountedDOMNode).tooltip('dispose');}catch(e){jQuery(this.refs.mountedDOMNode).tooltip('destroy');}}}});})((JSN=window.JSN||{}));