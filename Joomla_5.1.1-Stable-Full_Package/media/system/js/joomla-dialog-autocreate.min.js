import r from"joomla.dialog";/**
 * @copyright  (C) 2023 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */const c="[data-joomla-dialog]",i="joomlaDialog",d="joomlaDialogCache";document.addEventListener("click",l=>{const o=l.target.closest(c);if(!o)return;l.preventDefault();const n=!!o.dataset[d];if(n&&o.JoomlaDialogInstance){Joomla.Modal.setCurrent(o.JoomlaDialogInstance),o.JoomlaDialogInstance.show();return}const e=o.dataset[i]?JSON.parse(o.dataset[i]):{};o.nodeName==="A"&&(e.popupType||(e.popupType=o.hash?"inline":"iframe"),!e.src&&e.popupType==="iframe"?e.src=o.href:!e.src&&e.popupType==="inline"&&(e.src=o.hash)),delete e.popupTemplate;const a=new r(e);n&&(o.JoomlaDialogInstance=a),"closeOnMessage"in o.dataset&&window.addEventListener("message",t=>{t.source===(a.getBodyContent().contentWindow||window)&&a.close()}),a.addEventListener("joomla-dialog:close",()=>{Joomla.Modal.setCurrent(null),n||a.destroy();const{checkinUrl:t}=o.dataset,s="reloadOnClose"in o.dataset;t?Joomla.request({url:t,method:"POST",promise:!0}).then(()=>{s&&window.location.reload()}):s&&window.location.reload()}),a.JoomlaDialogTrigger=o,Joomla.Modal.setCurrent(a),a.show()});
