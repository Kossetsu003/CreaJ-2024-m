if(typeof PhpDebugBar>"u"){var PhpDebugBar={};PhpDebugBar.$=jQuery}(function(n){PhpDebugBar.Widgets={};var t=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),m=PhpDebugBar.Widgets.htmlize=function(i){return i.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")},_=PhpDebugBar.Widgets.renderValue=function(i,e){return typeof i!="string"?e?m(JSON.stringify(i,void 0,2)):JSON.stringify(i):i},T=PhpDebugBar.Widgets.highlight=function(i,e){return typeof i=="string"?typeof hljs>"u"?m(i):e?hljs.highlight(i,{language:e}).value:hljs.highlightAuto(i).value:(typeof hljs=="object"&&i.each(function(a,s){hljs.highlightElement(s)}),i)},x=PhpDebugBar.Widgets.createCodeBlock=function(i,e,a,s){var d=n("<pre />").addClass(t("code-block")),l=n("<code />").text(i+`
`).appendTo(d);if(e&&l.addClass("language-"+e),T(l).removeClass("hljs"),!isNaN(parseFloat(a))){var r=i.split(`
`).length,c=n("<ul />").prependTo(d);d.children().addClass(t("numbered-code"));for(var p=a;p<a+r;p++){var h=n("<li />").text(p).appendTo(c);s===p&&h.addClass(t("highlighted-line")).append("<span>&nbsp;</span>")}}return d},g=PhpDebugBar.Widgets.ListWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:t("list"),initialize:function(i){i.itemRenderer||(i.itemRenderer=this.itemRenderer),this.set(i)},render:function(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!!this.has("data"))for(var i=this.get("data"),e=0;e<i.length;e++){var a=n("<li />").addClass(t("list-item")).appendTo(this.$el);this.get("itemRenderer")(a,i[e])}})},itemRenderer:function(i,e){i.html(_(e))}}),k=PhpDebugBar.Widgets.KVListWidget=g.extend({tagName:"dl",className:t("kvlist"),render:function(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!!this.has("data")){var i=this;n.each(this.get("data"),function(e,a){var s=n("<dt />").addClass(t("key")).appendTo(i.$el),d=n("<dd />").addClass(t("value")).appendTo(i.$el);i.get("itemRenderer")(s,d,e,a)})}})},itemRenderer:function(i,e,a,s){i.text(a),e.html(m(s))}}),R=PhpDebugBar.Widgets.VariableListWidget=k.extend({className:t("kvlist varlist"),itemRenderer:function(i,e,a,s){n("<span />").attr("title",a).text(a).appendTo(i);var d=s&&s.value||s;d&&d.length>100&&(d=d.substr(0,100)+"...");var l=null;e.text(d).click(function(){e.hasClass(t("pretty"))?e.text(d).removeClass(t("pretty")):(l=l||x(s),e.addClass(t("pretty")).empty().append(l))})}}),N=PhpDebugBar.Widgets.HtmlVariableListWidget=k.extend({className:t("kvlist htmlvarlist"),itemRenderer:function(i,e,a,s){if(n("<span />").attr("title",n("<i />").html(a||"").text()).html(a||"").appendTo(i),e.html(s&&s.value||s),s&&s.xdebug_link){var d=n("<span />").addClass(t("filename")).text(s.xdebug_link.filename+(s.xdebug_link.line?"#"+s.xdebug_link.line:""));s.xdebug_link&&(s.xdebug_link.ajax?n('<a title="'+s.xdebug_link.url+'"></a>').on("click",function(){n.ajax(s.xdebug_link.url)}).addClass(t("editor-link")).appendTo(d):n('<a href="'+s.xdebug_link.url+'"></a>').addClass(t("editor-link")).appendTo(d)),d.appendTo(e)}}}),w=PhpDebugBar.Widgets.IFrameWidget=PhpDebugBar.Widget.extend({tagName:"iframe",className:t("iframe"),render:function(){this.$el.attr({seamless:"seamless",border:"0",width:"100%",height:"100%"}),this.bindAttr("data",function(i){this.$el.attr("src",i)})}}),F=PhpDebugBar.Widgets.MessagesWidget=PhpDebugBar.Widget.extend({className:t("messages"),render:function(){var i=this;this.$list=new g({itemRenderer:function(e,a){if(a.message_html)var s=n("<span />").addClass(t("value")).html(a.message_html).appendTo(e);else{var d=a.message;d.length>100&&(d=d.substr(0,100)+"...");var s=n("<span />").addClass(t("value")).text(d).appendTo(e);if(!a.is_string||a.message.length>100){var l=a.message;a.is_string||(l=null),e.css("cursor","pointer").click(function(){if(window.getSelection().type=="Range")return"";s.hasClass(t("pretty"))?s.text(d).removeClass(t("pretty")):(l=l||x(a.message,"php"),s.addClass(t("pretty")).empty().append(l))})}}if(a.xdebug_link){var r=n("<span />").addClass(t("filename")).text(a.xdebug_link.filename+(a.xdebug_link.line?"#"+a.xdebug_link.line:""));a.xdebug_link&&(a.xdebug_link.ajax?n('<a title="'+a.xdebug_link.url+'"></a>').on("click",function(){n.ajax(a.xdebug_link.url)}).addClass(t("editor-link")).appendTo(r):n('<a href="'+a.xdebug_link.url+'"></a>').addClass(t("editor-link")).appendTo(r)),r.appendTo(e)}a.collector&&n("<span />").addClass(t("collector")).text(a.collector).prependTo(e),a.label&&(s.addClass(t(a.label)),n("<span />").addClass(t("label")).text(a.label).prependTo(e))}}),this.$list.$el.appendTo(this.$el),this.$toolbar=n('<div><i class="phpdebugbar-fa phpdebugbar-fa-search"></i></div>').addClass(t("toolbar")).appendTo(this.$el),n('<input type="text" name="search" aria-label="Search" placeholder="Search" />').on("change",function(){i.set("search",this.value)}).appendTo(this.$toolbar),this.bindAttr("data",function(e){this.set({excludelabel:[],excludecollector:[],search:""}),this.$toolbar.find(t(".filter")).remove();var a=[],s=[],d=this,l=function(r,c){n("<a />").addClass(t("filter")).addClass(t(r)).text(c).attr("rel",c).on("click",function(){d.onFilterClick(this,r)}).appendTo(d.$toolbar)};e.forEach(function(r){a.includes(r.label||"none")||a.push(r.label||"none"),s.includes(r.collector||"none")||s.push(r.collector||"none")}),a.length>1&&a.forEach(r=>l("label",r)),s.length!==1&&(n("<a />").addClass(t("filter")).css("visibility","hidden").appendTo(d.$toolbar),s.forEach(r=>l("collector",r)))}),this.bindAttr(["excludelabel","excludecollector","search"],function(){var e=this.get("excludelabel")||[],a=this.get("excludecollector")||[],s=this.get("search"),d=!1,l=[];s&&s===s.toLowerCase()&&(d=!0),this.get("data").forEach(function(r){var c=d?r.message.toLowerCase():r.message;!e.includes(r.label||void 0)&&!a.includes(r.collector||void 0)&&(!s||c.indexOf(s)>-1)&&l.push(r)}),this.$list.set("data",l)})},onFilterClick:function(i,e){n(i).toggleClass(t("excluded"));var a=[];this.$toolbar.find(t(".filter")+t(".excluded")+t("."+e)).each(function(){a.push(this.rel==="none"||!this.rel?void 0:this.rel)}),this.set("exclude"+e,a)}}),M=PhpDebugBar.Widgets.TimelineWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:t("timeline"),render:function(){this.bindAttr("data",function(i){var e=function(o){return o<.001?(o*1e6).toFixed()+"\u03BCs":o<.1?(o*1e3).toFixed(2)+"ms":o<1?(o*1e3).toFixed()+"ms":o.toFixed(2)+"s"},a=function(u){if(u===0||u===null)return"0B";var y=u<0?"-":"",u=Math.abs(u),v=Math.log(u)/Math.log(1024),j=["B","KB","MB","GB","TB"];return y+Math.round(Math.pow(1024,v-Math.floor(v))*100)/100+j[Math.floor(v)]};if(this.$el.empty(),i.measures){for(var s={},d=0;d<i.measures.length;d++){var l=i.measures[d];s[l.label]||(s[l.label]={count:0,duration:0,memory:0}),s[l.label].count+=1,s[l.label].duration+=l.duration,s[l.label].memory+=l.memory||0;var r=n("<div />").addClass(t("measure")),c=n("<li />"),p=(l.relative_start*100/i.duration).toFixed(2),h=Math.min((l.duration*100/i.duration).toFixed(2),100-p);if(r.append(n("<span />").addClass(t("value")).css({left:p+"%",width:h+"%"})),r.append(n("<span />").addClass(t("label")).text(l.label+" ("+l.duration_str+(l.memory?"/"+l.memory_str:"")+")")),l.collector&&n("<span />").addClass(t("collector")).text(l.collector).appendTo(r),r.appendTo(c),this.$el.append(c),l.params&&!n.isEmptyObject(l.params)){var W=n('<table><tr><th colspan="2">Params</th></tr></table>').hide().addClass(t("params")).appendTo(c);for(var b in l.params)typeof l.params[b]!="function"&&W.append('<tr><td class="'+t("name")+'">'+b+'</td><td class="'+t("value")+'"><pre><code>'+l.params[b]+"</code></pre></td></tr>");c.css("cursor","pointer").click(function(){if(window.getSelection().type=="Range")return"";var o=n(this).find("table");o.is(":visible")?o.hide():o.show()})}}s=n.map(s,function(o,f){return{label:f,data:o}}).sort(function(o,f){return f.data.duration-o.data.duration});var C=n("<table></table>").addClass(t("params"));n.each(s,function(o,f){h=Math.min((f.data.duration*100/i.duration).toFixed(2),100),C.append('<tr><td class="'+t("name")+'">'+f.data.count+" x "+n("<i />").text(f.label).html()+" ("+h+'%)</td><td class="'+t("value")+'"><div class="'+t("measure")+'"><span class="'+t("value")+'"></span><span class="'+t("label")+'">'+e(f.data.duration)+(f.data.memory?"/"+a(f.data.memory):"")+"</span></div></td></tr>"),C.find("span."+t("value")+":last").css({width:h+"%"})}),this.$el.append("<li/>").find("li:last").append(C)}})}}),E=PhpDebugBar.Widgets.ExceptionsWidget=PhpDebugBar.Widget.extend({className:t("exceptions"),render:function(){this.$list=new g({itemRenderer:function(i,e){if(n("<span />").addClass(t("message")).text(e.message).appendTo(i),e.file){var a=n("<span />").addClass(t("filename")).text(e.file+"#"+e.line);e.xdebug_link&&(e.xdebug_link.ajax?n('<a title="'+e.xdebug_link.url+'"></a>').on("click",function(){n.ajax(e.xdebug_link.url)}).addClass(t("editor-link")).appendTo(a):n('<a href="'+e.xdebug_link.url+'"></a>').addClass(t("editor-link")).appendTo(a)),a.appendTo(i)}if(e.type&&n("<span />").addClass(t("type")).text(e.type).appendTo(i),e.surrounding_lines){var s=e.line-3<=0?1:e.line-3,d=x(e.surrounding_lines.join(""),"php",s,e.line).addClass(t("file")).appendTo(i);e.stack_trace_html||i.click(function(){d.is(":visible")?d.hide():d.show()})}if(e.stack_trace_html){var l=n("<span />").addClass(t("filename")).html(e.stack_trace_html);l.appendTo(i)}else e.stack_trace&&e.stack_trace.split(`
`).forEach(function(r){var c=n("<div />");n("<span />").addClass(t("filename")).text(r).appendTo(c),c.appendTo(i)})}}),this.$list.$el.appendTo(this.$el),this.bindAttr("data",function(i){this.$list.set("data",i),i.length==1&&this.$list.$el.children().first().find(t(".file")).show()})}})})(PhpDebugBar.$);
